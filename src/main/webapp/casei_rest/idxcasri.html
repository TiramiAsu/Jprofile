<!DOCTYPE html>
<html>
    <head>
        <title>Case I</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
        <script>
            var xhttp = new XMLHttpRequest();

            function queryUser() {
                var method = "GET";
                var id = document.getElementById("readid").value;
                var path = "/Jprofile/casei/user/" + id;

                doRun(xhttp,method,path);
                console.log(path);
                xhttp.open(method, path, true);
                xhttp.send();
            }

            function queryUsers() {
                var method = "GET";
                var path = "/Jprofile/casei/users"

                doRun(xhttp, method, path);
                console.log(path);
                xhttp.open(method, path, true);
                xhttp.send();
            }

            function createUser() {
                var method = "POST";
                var path = "/Jprofile/casei/user/";
                var args = "createname=" + document.getElementById("createname").value;

                doRun(xhttp, method, path);
                console.log(path);
                
                xhttp.open(method, path, true);
                xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhttp.send(args);
            }
            
            function updateUser() {
                var method = "PUT";
                var path = "/Jprofile/casei/user/" + document.getElementById("updateid").value;
                var args = "updatename=" + document.getElementById("updatename").value;
                
                doRun(xhttp, method, path);
                console.log(path);
                
                xhttp.open(method, path, true);
                xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhttp.send(args);
            }
            
            function deleteUser() {
                var method = "DELETE";
                var path = "/Jprofile/casei/user/" + document.getElementById("deleteid").value;
                
                doRun(xhttp, method, path);
                console.log(path);
                
                xhttp.open(method, path, true);
                xhttp.send();
            }

            function doRun(xhttp, method, path) {
                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {
                        console.log(this.responseText);
                        document.getElementById("result").innerText = this.responseText;
                    }
                };
                document.getElementById("req_method").innerText = "("+method+")";
                document.getElementById("req_url").innerText = path;
            }
        </script>

    </head>
    <body>
        <form class="pure-form" style="width: 700px; margin: 0px auto; padding-top: 100px;">
            <fieldset>
                <legend>
                    <h3><b>User REST</b></h3>
                    用 RESTful 方式設計，輸入 ID / User Name 來操作 CRUD
                </legend>
                <table>
                    <tr>
                        <td>Create:&emsp;</td>
                        <td>
                            <input type="text" placeholder="User Name" id="createname" >
                            <button type="button" class="pure-button pure-button-primary" onclick="createUser()" >Create</button><p>
                        </td>
                    </tr>
                    <tr>
                        <td>Read:&emsp;</td>
                        <td><input type="number" placeholder="ID" id="readid">
                            <button type="button" class="pure-button pure-button-primary" onclick="queryUser()" >Query User</button>
                            &emsp;
                            <button type="button" class="pure-button pure-button-primary" onclick="queryUsers()" >Query Users</button><p>
                        </td>
                    </tr>
                    <tr>
                        <td>Update:&emsp;</td>
                        <td><input type="number" placeholder="ID" id="updateid">    
                            <input type="text" placeholder="User Name" id="updatename">
                            <button type="button" class="pure-button pure-button-primary" onclick="updateUser()">Update</button><p>
                        </td>
                    </tr>
                    <tr>
                        <td>Delete:&emsp;</td>
                        <td><input type="number" placeholder="ID" id="deleteid">
                            <button type="button" class="pure-button pure-button-primary" onclick="deleteUser()">Delete</button><p>
                        </td>
                    </tr>
                </table>
            </fieldset>
            
            <table>
                <tr>
                    <div><br>Request URL:</div>
                    <td>
                        <div id="req_method">(method)</div>
                    </td>
                    <td>
                        <div id="req_url">url</div>
                    </td>
                </tr>
            </table>
            
            <div><br>JSON:</div>
            <div id="result">(data)</div>
            
        </form>
    </body>
</html>
